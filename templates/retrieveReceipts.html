{% extends "base.html" %}
{% block title %}Retrieve Receipts{% endblock %}
{% block content %}
<div class="retrieveReceipts">
    <a href="/"><img class="back" src="{{ url_for('static', filename='backbutton.png')}}"></a>
    <div class="background">
        <h1 class="display-4">View Past Purchases</h1>
        <div>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Receipt ID</th>
                        <th>Credit Card Number</th>
                        <th>Items</th>
                        <th>Total Price</th>
                    </tr>
                </thead>
                <tbody>
                    {% for receipt in receipts_list %}
                    <tr>
                        <td>{{ receipt.get_receipt_id() }}</td>
                        <td>{{ receipt.get_creditcard() }}</td>
                        <td>
                            {% for item in receipt.get_items() %}
                                {{ item["name"] }} [{{ item["quantity"] }}] <br>
                            {% endfor %}
                        </td>
                        <td>
                            ${{
                                "%.2f"|format(
                                    receipt.get_items() | map(attribute="price") | sum
                                )
                            }}
                        </td>
                        <td>
                            <form action="{{url_for('delete_receipt', id=receipt.get_receipt_id())}}" method="POST">
                                <input type="submit" value="Delete" class="btn btn-danger">
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
